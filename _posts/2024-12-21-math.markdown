---
layout:     post
title:      "亲属间染色体相似程度分析"
subtitle:   ""
date:       2024-12-21 00:12:00
author:     "zdd"
header-img: "img/bg-walle.jpg"
catalog: true
tags:
    - zdd的奇思妙想
mathjax: true
---

> 这篇论文是概统的大作业。

# 亲属间染色体相似程度分析


**摘要：** 本文基于染色体的减数分裂和受精作用原理，分析了近亲属间染色体的相似程度.首先根据减数分裂和受精作用原理构建染色体遗传的数学模型；然后利用概率论知识分析亲属间相同染色体条数的数学期望，利用林德伯格中心极限定理将染色体相似程度的分布近似为正态分布并求其置信区间的近似值；最后利用计算机进行模拟实验，验证正态近似的合理性，并用假设检验的方法分析上述模型的正确性.

## 1 问题背景和介绍

### 1.1	问题背景

人类通过生殖细胞内染色体的减数分裂和受精作用进行遗传信息的传递.染色体内含有遗传信息的携带者——基因，决定着个体的性状.每个人拥有携带遗传信息的23对（46条）染色体，亲属之间由于血缘关系可能存在相同的染色体.分析亲属之间染色体的相似程度，可以了解遗传信息的相似性，进而可以分析亲属间遗传性状的相似性和遗传病的患病风险等，具有广泛用途.

### 1.2	减数分裂和受精作用

正常情况下每个人的体细胞有23对染色体，其中有22对为常染色体，1对为性染色体.对于常染色体，每对染色体的两条染色体之间形状和大小一般都相同，但是携带着不同的遗传信息；不同对的染色体形状和大小不同，对生物性状发挥不同的作用.性染色体分为两种，一种称为X染色体，一种称为Y染色体，女性的一对性染色体的组成是两条不同的X染色体（XX），男性的一对性染色体的组成为一条X染色体和一条Y染色体（XY）.人体染色体组成如图1所示.

减数分裂是进行有性生殖的生物，在产生成熟生殖细胞时进行的染色体数目减半的细胞分裂.男性和女性产生的生殖细胞分别是精子和卵细胞.每个生殖细胞含有23条染色体，每一条都来自该生殖细胞产生者每对染色体中的任意一条（对于性染色体而言，精子可能含有一条X染色体或一条Y染色体，卵细胞只可能含一条X染色体）.进行受精作用时，精子和卵细胞结合形成受精卵，其所含染色体条数重新回到23对，每一对的染色体一条来自父方，一条来自母方，此受精卵将发育为一个新的个体.若该受精卵染色体组成为XX,，则发育为女性；若为XY，则发育为男性.

![图片](https://notes.sjtu.edu.cn/uploads/upload_ac622451ba1a82f98c6810477e4dfa74.png)
<font size=1>**图1** 人体染色体的组成.人体由22对常染色体和1对性染色体组成，图中A为男性的染色体组成，性染色体为XY；B为女性的染色体组成，性染色体为XX.产生生殖细胞时，每对染色体随机取其中一条，两生殖细胞组合形成受精卵，重组为23对染色体.</font>

### 1.3	问题提出和简化

本文将两亲属间染色体的相似度定义为二者相同染色体条数占每个人染色体总条数（46条）的比率.本文将会分析不同关系的亲属间染色体相似度的数学期望和近似的概率分布及其置信区间.

为简化问题，不考虑减数分裂过程中染色体数目异常、染色体片段交换等特殊情况；也不考虑近亲结婚，因此认为每个个体来自父方和来自母方的染色体必定不会出现相同的一对.

## 2 问题解决

### 2.1两亲属间常染色体（第1至22号染色体）相同条数的分析

首先，对于父母和儿子或女儿的关系，子代的染色体必定一半来自父亲，一半来自母亲；若研究的两亲属没有共同的双亲（也即完全没有血缘关系），则认为二者不具有相同的染色体；对于同卵双胞胎，认为染色体完全相同.这几类关系不在考虑范围之内.

对于其他亲属关系，考虑二者最近的共同双亲（例如，某人A与其母亲的亲姐姐最近的共同双亲为A的外祖父、外祖母；A与其爷爷的亲弟弟最近的共同双亲为A的曾祖父、曾祖母），两研究对象与其最近共同双亲相隔的代数分别记为$d_1$和$d_2$.示例如图2所示.

![](https://notes.sjtu.edu.cn/uploads/upload_fd259a3eb1991544b3a79cd4a8453d57.png)
<font size=1>**图2** 遗传系谱图示例.图中蓝色和绿色标注的个体分别为研究对象1和研究对象2，红色标注的为他们的最近共同双亲，在图上所给的例子中，研究对象1与其最近共同双亲相隔的代数$d_1=3$，研究对象2与其最近共同双亲相隔的代数$d_2=2$.</font>

设随机变量$X_i(i\in\left\{1,2,\ldots,22\right\})$表示研究对象1和研究对象2第i对染色体相同条数.向量${A}_j=(p_1,p_2,p_3,p_4)(j=1,2)$的第1~4个元素分别表示研究对象$j$具有女性共同双亲$i$号染色体第1，2条染色体，男性共同双亲$i$号染色体第1，2条染色体的概率.

不难证明，若$d_1=d_2=1$，则$P\left(X_i=0\right)=P\left(X_i=2\right)=0.25，P\left(X_i=1\right)=0.5$.

如若不然，则$X_i$的值只能取0或1.且满足
$${A}_j=\left(\frac{1}{2^{d_j}},\frac{1}{2^{d_j}},\frac{1}{2^{d_j}},\frac{1}{2^{d_j}}\right)$$

因为研究对象1和2的染色体排布相互独立，不难证明
$$P\left(X_i=1\right)={A}_1\cdot{A}_2=\frac{1}{2^{d_1+d_2-2}}$$

$$P\left(X_i=0\right)=1-P\left(X_i=1\right)$$

### 2.2两亲属间性染色体（第23号染色体）相同条数的分析
性染色体是否相同受研究对象本身性别及其祖先性别的影响，分析较为复杂.

先考虑$d_1=d_2=1$的简单情况.不难发现，若两研究对象性别相同，有$P\left(X_{23}=1\right)=0.5$，$P\left(X_{23}=2\right)=0.5$；若两研究对象性别不同，有$P\left(X_{23}=0\right)=0.5$，$P\left(X_{23}=1\right)=0.5$.
如若不然，考虑共同双亲到研究对象的路径.如图1中的研究对象1路径为“共同双亲→儿子→儿子→儿子（研究对象1）”，研究对象2路径为“共同双亲→儿子→女儿（研究对象2）”.如果女性记为0，男性记为1，则两条路径可以简记为“111”和“10”.
定义向量${B}_j=\left(p_1,p_2,p_3,p_4\right)\left(j=1,2\right)$的第1~4个元素分别表示研究对象j具有女性共同双亲第1，2条X染色体，男性共同双亲的X和Y染色体的概率.容易证明

$$P\left(X_{23}=1\right)={B}_1\cdot{B}_2$$

$$P\left(X_{23}=0\right)=1-P\left(X_{23}=1\right)$$


![](https://notes.sjtu.edu.cn/uploads/upload_8b1e61465879cb819271b5ca06fb8f3e.png)
<font size=1>**图3** 在共同双亲相同的前提下，不同研究对象的${B}$值.图中每个蓝色或黄色的方格表示一个研究对象，共同双亲到研究对象的路径由图中的连线表示，方格中的数值表示研究对象的${B}$值.如图2中的研究对象1，路径为“111”，${B}_1=\left(0,0,0,1\right)$，研究对象2，路径为“10”，${B}_2=\left(1/2,1/2,0,0\right)$.</font>

由于${B}$值受研究对象及其祖先性别的影响，难以直接写出某个研究对象$0{B}$值的表达式.但仍然可以用递归的方法计算出${B}$值，如图3所示.推导的过程较为繁琐但思路浅显，故略去.公式如下：
$$f_{11}\left(\left(p_1,p_2,p_3,p_4\right)\right)=\left(0,0,0,p_4\right)$$

$$f_{10}\left(\left(p_1,p_2,p_3,p_4\right)\right)=\left(p_1,p_2,p_{3,}0\right)$$

$$f_{00}\left(\left(p_1,p_2,p_3,p_4\right)\right)=f_{01}\left(\left(p_1,p_2,p_3,p_4\right)\right)=\frac{1}{2}\left(p_1,p_2,p_{3,}p_4\right)$$

其中f下标第一个数代表亲代性别，第二个数代表子代性别.例如图2研究对象1的${B}$值可以表示为${B}_1=f_{11}\left(f_{11}\left(\left(1/2,1/2,0,1\right)\right)\right)$，研究对象2的${B}$值可以表示为${B}_2=f_{10}\left(\left(1/2,1/2,0,1\right)\right)$.在实际应用中，可以直接用计算机程序计算出${B}$值.

### 2.3	两亲属染色体相似度的数学期望


设随机变量$X=\sum_{i=1}^{22}X_i+X_{23}$为相同染色体总条数，$Y=\frac{X}{46}$为两亲属染色体的相似度.在不满足$d_1=d_2=1$的条件下，对任意$i\in\{1,2,\ldots,23\}$，有

在$d_1=d_2=1$的条件下求单条染色体的数学期望和方差的思路也非常简单，这里略去.

由相互独立性可得

$$E\left(X\right)=\sum_{i=1}^{23}{{E(X}_i)}$$

于是染色体相似度的数学期望

$$E\left(Y\right)=\frac{E\left(X\right)}{46}$$

### 2.4	染色体相似程度概率分布的近似

随机变量$X_1,X_2,\ldots,X_{22},X_{23}$是独立的，且每个随机变量的方差存在且有限；若认为常染色体的数目相对性染色体而言足够多，可以认为这组随机变量满足林德伯格条件.由林德伯格中心极限定理近似得

$$X\ \sim  N(μ,σ^2)$$

这里$\mu=\sum_{i=1}^{23}E\left(X_i\right)=E\left(X\right),\sigma^2=\sum_{i=1}^{23}D\left(X_i\right)$.

接下来利用上述近似求染色体相似条数和染色体相似度的置信区间.设来自容量为$n$总体的一个样本的样本均值为$\bar{X}$,因为$\mu$和$\sigma$为已知，故选取枢轴量$U=\frac{\overline{X}-\mu}{\sigma/\sqrt n}\sim N\left(0,1\right)$,可得$\mu$的置信度为$1-\alpha$的置信区间为

$$\left(\bar{X}-u_{\alpha/2}\frac{\sigma}{\sqrt n},\bar{X}-u_{\alpha/2}\frac{\sigma}{\sqrt n}\right)$$

也即染色体相似度的置信区间为

$$\left(\frac{1}{46}\left(\bar{X}-u_{\alpha/2}\frac{\sigma}{\sqrt n}\right),\frac{1}{46}\left(\bar{X}-u_{\alpha/2}\frac{\sigma}{\sqrt n}\right)\right)$$

## 3	实验验证

为验证上述理论的正确性，以笔者（男，记为研究对象1）及其表弟（母亲的亲姐姐的儿子，记为研究对象2）为例，用计算机模拟的方式对上述理论进行验证.

对于这一对研究对象，通过第2节的方法可得，$P\left(X_i=1\right)=1-P\left(X_i=0\right)=\frac{1}{4}\forall i\in\{1,2,\ldots,22\}，P\left(X_{23}=1\right)=1-P\left(X_{23}=0\right)=\frac{3}{8},E\left(X\right)=5.875,E\left(Y\right)=12.77%$，近似正态分布$X\sim N\left(5.875,4.359\right)$

### 3.1	验证正态近似的合理性

首先，用常规方法对X的分布律进行求取.考虑随机变量$T=\sum_{i=1}^{22}X_i$，表示二者相同的常染色体条数.不难发现

$$T\sim B\left(22,1/4\right)$$

于是

$$P\left(T=k\right)={C_{22}^k\left(1/4\right)}^k\left(3/4\right)^{22-k}, k\ \in\{0,1,2,\ldots,22\}$$

将常染色体数和性染色体数相加，可得

$$P\left(X=k\right)=P\left(T=k\right)P\left(X_{23}=0\right)+P\left(T=k-1\right)P\left(X_{23}=1\right)\ \emsp k\ \in\{0,1,2,\ldots,23\}$$

正态分布的概率密度函数为

$$f_X\left(x\right)=\frac{1}{\sqrt{2\pi}\ \sqrt{4.359}}e^{-\frac{\left(x-5.875\right)^2}{8.718}}$$

利用Origin作图软件，将常规方法计算所得的概率绘制成柱状图，与正态分布的概率密度曲线绘制在同一坐标系内，如图4所示.

![](https://notes.sjtu.edu.cn/uploads/upload_303a4e371808974c107130e8260ec5db.png)
<font size=1>**图4** 将常规方法计算出来的概率绘制成直方图，与近似得出的概率密度函数绘制在同一坐标系中进行比较.观察图像可以看出，这一近似的拟合效果非常好.</font>

### 3.2 计算机模拟减数分裂和受精作用过程
本实验采用c++代码模拟示例中的减数分裂和受精作用过程，完整代码详见附录.该程序实现了模拟100次实验对象1和2的外公、外婆生下大女儿、小女儿；小女儿和大女儿再分别生下研究对象1和2的过程.实现思路如下：

(1)构造一列$23\times2$的矩阵${p}_\mathbf{0},{p}_\mathbf{1},{p}_\mathbf{2},{p}_\mathbf{3},{p}_\mathbf{4},{p}_\mathbf{5}$，分别代表研究对象的外婆、外公，研究对象1的母亲，研究对象2的母亲，研究对象1，研究对象2.${p}_{{i},{j},{k}}$代表第i个人第j对染色体的第k条的代号.外婆，外公某一对染色体的组成分别记为1,2和3，4，外来染色体（即不可能两两相同的染色体,与本次实验无关，全部记为0）.代码如下：
![](https://notes.sjtu.edu.cn/uploads/upload_2cc49bd23253e325f089c823d958a504.png)

值得注意的是，对于第23条染色体，只有标号为4的染色体是Y染色体，其余为X染色体.

(2)	模拟精子和卵细胞结合的过程.外公、外婆每组染色体随机分配一条给大女儿和小女儿，然后再用同样的方法产生研究对象1和2的染色体分布.在本段代码中，不符合实验条件的情况（如外公和外婆生了儿子）都已经被排除在外.代码如下：
![](https://notes.sjtu.edu.cn/uploads/upload_8f898cdcd7421156b68e75f188062815.png)
![](https://notes.sjtu.edu.cn/uploads/upload_65cf50341753600d8035f7483f06cc05.png)

### 3.3 采用假设检验的方法验证模型的正确性

本实验将采用正态分布近似的方式进行假设检验.运行一次上述程序，输出进行$n=100$次实验的样本方差$\overline{x}=5.88$.由于该实验方差$\sigma^2=4.359$为已知量，提出原假设与备择假设

$$H_0:\mu=\mu_0,H_1:\mu\neq\mu_0$$

其中$\mu_0=5.875$.

采用检验统计量

$$U=\frac{\overline{X}-\mu_0}{\sigma/\sqrt n}~N\left(0,1\right)$$

在显著性水平$\alpha=0.05$下选取拒绝域

$$\frac{\left|\overline{X}-\mu_0\right|}{\sigma/\sqrt n}>u_{\alpha/2}=1.96$$

用$\overline{x}=5.88$替换$\overline{X}$，可以得到

$$\frac{\left|\overline{x}-\mu_0\right|}{\sigma/\sqrt n}=0.024<u_{\alpha/2}$$

因此原假设成立.这说明了该数学模型的正确性.

## 4	总结与展望

本文利用染色体的减数分裂和受精作用原理建立数学模型，分析了亲属间染色体的相似程度.第1节分析了减数分裂和受精作用的机制，并对问题进行简化处理.第二节对问题进行分析，推断出亲属间染色体相似程度的数学期望；并使用林德伯格中心极限定理，将相同染色体条数的概率分布近似为正态分布，并给出了在此近似下置信区间的计算.在第3节中，本文采用一个具体的例子，对所建立的模型进行验证：首先将常规计算方法得到的概率分布和正态分布近似进行比对，发现正态分布完美地拟合了原来的常规计算方法算出的概率，极大地简化了计算；然后设计程序模拟减数分裂和受精作用，利用假设检验的方法证明了该数学模型很好地预测了两亲属间染色体的相似程度.

推测两亲属间染色体的相似程度具有一定的实际意义，具有继续深入研究的空间.未来，可利用本文得出的算法和结论，与市面上现有的“亲属关系计算器”相结合，设计出一个程序，输入二者的亲属关系，直接推断出二者染色体的相似性.在已知两亲属染色体组成的前提下，采用本文提出的数学期望和置信区间方法，可以用于反推亲属关系或预测新产生的子代的染色体组成.本文提出的正态分布近似，也为染色体相似程度的计算带来极大的方便.又因为染色体的相似程度和基因的相似程度呈正相关，将该研究与基因的研究相结合也具有一定的研究价值.


![](https://notes.sjtu.edu.cn/uploads/upload_dbf615363531797f91fc762bc00e251d.png)
![](https://notes.sjtu.edu.cn/uploads/upload_2c2f7d02c81a1367652f5b38b9b6cf53.png)
![](https://notes.sjtu.edu.cn/uploads/upload_e4bc375b9c7a5578e7f21e9bef05c565.png)
